# Demo GIF Documentation

This document explains how the nerves_burner demo GIF is generated and maintained.

## Overview

The demo GIF showcases the nerves_burner interactive CLI workflow. It is automatically generated by GitHub Actions using [VHS (Video Home System)](https://github.com/charmbracelet/vhs), a tool for recording terminal sessions from script files.

## Components

### 1. VHS Tape Script (`demo.tape`)

The VHS tape script defines:
- Output filename and format (demo.gif)
- Visual settings (font size, dimensions, theme, padding)
- Typing speed and timing
- Sequence of commands and inputs

**Key Settings:**
- Theme: Dracula (provides good contrast and readability)
- Dimensions: 1400x900 pixels
- Font Size: 14pt
- Typing Speed: 100ms per character

### 2. Mock Script (`mock_nerves_burner.sh`)

A bash script that simulates the nerves_burner CLI without requiring:
- Elixir/Erlang installation
- fwup installation
- Network access
- Actual hardware devices

**Features:**
- Accurate ANSI color codes matching the real CLI
- Progress bar animations
- All menu options and prompts
- Realistic timing delays
- Complete workflow simulation

### 3. GitHub Actions Workflow (`.github/workflows/demo.yml`)

Automatically generates the demo GIF when:
- Demo files are modified (demo.tape, mock_nerves_burner.sh)
- Manually triggered via workflow_dispatch
- Changes are pushed to main branch

**Workflow Steps:**
1. Checkout repository
2. Make mock script executable
3. Run VHS to generate demo.gif
4. Verify GIF was created
5. Upload as artifact (for PR preview)
6. Commit GIF back to repository (main branch only)

## Updating the Demo

### To Change the Workflow or Content

Edit `demo.tape` to modify:
- Visual appearance (theme, size, font)
- Timing and pacing
- Input sequence
- What parts of the workflow are shown

Edit `mock_nerves_burner.sh` to modify:
- CLI output content
- Available menu options
- Progress indicators
- Colors and formatting
- Simulated behavior

### To Generate Locally

1. Install VHS:
   ```bash
   # macOS
   brew install vhs
   
   # Linux
   # See https://github.com/charmbracelet/vhs#installation
   ```

2. Generate the GIF:
   ```bash
   chmod +x mock_nerves_burner.sh
   vhs demo.tape
   ```

3. The `demo.gif` file will be created in the current directory.

### To Test Changes

1. Make changes to `demo.tape` or `mock_nerves_burner.sh`
2. Generate locally to preview
3. Commit and push to a branch
4. The workflow will run automatically on PR
5. Download the artifact to preview before merge

## Design Decisions

### Why a Mock Script?

- **No Dependencies**: Can run in CI without Elixir/fwup installation
- **Deterministic**: Same output every time, no network variability
- **Fast**: Generates in seconds, not minutes
- **Safe**: No actual device operations, no risk of errors

### Why VHS?

- **Professional Quality**: Produces crisp, optimized GIFs
- **Script-Based**: Easy to version control and review changes
- **Reproducible**: Same script = same output
- **GitHub Action**: Official action available for easy CI integration

### Theme Choice (Dracula)

The Dracula theme was chosen because:
- High contrast for readability
- Professional appearance
- Matches common terminal setups
- Good color differentiation for UI elements

### Dimensions (1400x900)

- Wide enough to show long paths and output
- Tall enough to show multiple menu options
- Not too large (keeps file size reasonable)
- Good aspect ratio for README embedding

## Troubleshooting

### GIF Not Generated

1. Check workflow logs in GitHub Actions
2. Verify mock script is executable (`chmod +x`)
3. Ensure VHS syntax is valid in demo.tape
4. Check for errors in mock script logic

### GIF Shows Errors

1. Test mock script locally with piped input
2. Check for bash syntax errors
3. Verify all read commands have input in demo.tape
4. Ensure timing is adequate for output rendering

### Workflow Not Triggering

1. Check path filters in demo.yml
2. Verify branch is main (for commit-back)
3. Check workflow permissions
4. Ensure files are properly committed

## File Sizes

- `demo.tape`: ~1KB (text file)
- `mock_nerves_burner.sh`: ~5KB (bash script)
- `demo.gif`: Expected ~2-5MB (depends on duration and optimization)

## Maintenance

The demo should be updated when:
- Major UI changes are made to nerves_burner
- New features are added to the workflow
- Supported firmware or platforms change significantly
- Visual design is updated

Keep the demo:
- Current with actual CLI behavior
- Concise (under 30 seconds ideal)
- Focused on the happy path
- Clear and easy to follow
